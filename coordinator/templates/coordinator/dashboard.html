{% extends "coordinator/base.html" %}
{% load static %}
{% block content %}
 <!-- [ Main Content ] start -->
 <div class="pcoded-main-container">
    <div class="pcoded-content">
        <!-- [ breadcrumb ] start -->
        <div class="page-header">
            <div class="page-block">
                <div class="row align-items-center">
                    <div class="col-md-12">
                        <div class="page-header-title">
                            <h5 class="m-b-10">Coordinator Dashboard</h5>
                        </div>
                        <ul class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url "coordinator_dashboard" %}"><i class="feather icon-home"></i></a></li>
                            <li class="breadcrumb-item"><a href="#!">dashboard</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- [ breadcrumb ] end -->
        <div class="row">
            <div class="col-lg-7 col-md-12">
                <!-- support-section start -->
                <div class="row">
                    <div class="col-sm-6">
                        <div class="card support-bar overflow-hidden">
                            <div class="card-body pb-0">
                                <h2 class="m-0">{{ total_registered_students }}</h2>  <!-- Display total registered students -->
                                <span class="text-c-blue">Registered Students</span>
                                <p class="mb-3 mt-3">Total number of students registered for the events.</p>
                            </div>
                            <div id="support-chart"></div>  <!-- Optional: Update or remove chart if irrelevant -->
                            <div class="card-footer bg-primary text-white">
                                <div class="row text-center">
                                    <div class="col">
                                        <h4 class="m-0 text-white">{{ total_active_students }}</h4>  <!-- Display active students count -->
                                        <span>Active Students</span>
                                    </div>
                                    <div class="col">
                                        <h4 class="m-0 text-white">{{ total_inactive_students }}</h4>  <!-- Display inactive students count -->
                                        <span>Inactive Students</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        
                    </div>
                    <div class="col-sm-6">
                        <div class="card support-bar overflow-hidden">
                            <div class="card-body pb-0">
                                <h2 class="m-0">{{ total_coordinators }}</h2> <!-- Display total number of coordinators -->
                                <span class="text-c-green">Coordinators</span>
                                <p class="mb-3 mt-3">Total number of coordinators in the system.</p>
                            </div>
                            <div id="coordinator-chart1"></div> <!-- Optional chart element; update ID if needed -->
                            <div class="card-footer bg-success text-white">
                                <div class="row text-center">
                                    <div class="col">
                                        <h4 class="m-0 text-white">{{ total_active_coordinators }}</h4> <!-- Display active coordinators count -->
                                        <span>Active</span>
                                    </div>
                                    <div class="col">
                                        <h4 class="m-0 text-white">{{ total_inactive_coordinators }}</h4> <!-- Display inactive coordinators count -->
                                        <span>Inactive</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
                
                <!-- support-section end -->
            </div>
            <div class="col-lg-5 col-md-12">
                <!-- page statustic card start -->
                <div class="row">
                    <div class="col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-8">
                                        <h4 class="text-c-yellow">{{ total_assigned_events }}</h4> <!-- Display total assigned events -->
                                        <h6 class="text-muted m-b-0">Total Assigned Events</h6> <!-- Label updated to "Total Assigned Events" -->
                                    </div>
                                    <div class="col-4 text-right">
                                        <i class="feather icon-bar-chart-2 f-28"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer bg-c-yellow">
                                <div class="row align-items-center">
                                    <div class="col-9">
                                        <p class="text-white m-b-0">Assigned Event Stats</p> <!-- Footer text updated as needed -->
                                    </div>
                                    <div class="col-3 text-right">
                                        <i class="feather icon-trending-up text-white f-16"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        
                    </div>
                    <div class="col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-8">
                                        <h4 class="text-c-red">{{ total_generated_certificates }}</h4> <!-- Display total generated certificates -->
                                        <h6 class="text-muted m-b-0">Generated Certificates</h6> <!-- Update label to "Generated Certificates" -->
                                    </div>
                                    <div class="col-4 text-right">
                                        <i class="feather icon-calendar f-28"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer bg-c-red">
                                <div class="row align-items-center">
                                    <div class="col-9">
                                        <p class="text-white m-b-0">Certificate Stats</p> <!-- Update as desired -->
                                    </div>
                                    <div class="col-3 text-right">
                                        <i class="feather icon-trending-down text-white f-16"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    
            
                </div>
                <!-- page statustic card end -->
            </div>

            <div class="col-xl-6 col-md-12">
                <div class="card table-card">
                    <div class="card-header">
                        <h5>Assigned Events</h5> <!-- Update header to reflect assigned events -->
                        <div class="card-header-right">
                            <div class="btn-group card-option">
                                <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="feather icon-more-horizontal"></i>
                                </button>
                                <ul class="list-unstyled card-option dropdown-menu dropdown-menu-right">
                                    <li class="dropdown-item full-card"><a href="#!"><span><i class="feather icon-maximize"></i> maximize</span><span style="display:none"><i class="feather icon-minimize"></i> Restore</span></a></li>
                                    <li class="dropdown-item minimize-card"><a href="#!"><span><i class="feather icon-minus"></i> collapse</span><span style="display:none"><i class="feather icon-plus"></i> expand</span></a></li>
                                    <li class="dropdown-item reload-card"><a href="#!"><i class="feather icon-refresh-cw"></i> reload</a></li>
                                    <li class="dropdown-item close-card"><a href="#!"><i class="feather icon-trash"></i> remove</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Event Title</th>
                                        <th>Date</th>
                                        <th>Location</th>
                                        <th>Sport Type</th>
                                        <th class="text-right">Coordinator</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for event in assigned_events %}  <!-- Iterate over assigned_events instead of events -->
                                    <tr>
                                        <td>
                                            <div class="d-inline-block align-middle">
                                                <div class="d-inline-block">
                                                    <h6>{{ event.title }}</h6>
                                                    <p class="text-muted m-b-0">{{ event.description|truncatewords:10 }}</p>
                                                </div>
                                            </div>
                                        </td>
                                        <td>{{ event.date|date:"M, d" }}</td>
                                        <td>{{ event.location }}</td>
                                        <td><label class="badge badge-light-primary">{{ event.sport_type }}</label></td>
                                        <td class="text-right">{{ event.coordinator.full_name }}</td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="5" class="text-center">No assigned events found</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-xl-6 col-md-12">
                <div class="card latest-update-card">
                    <div class="card-header">
                        <h5>Event Registered Students</h5> <!-- Updated title to reflect event registration -->
                        <div class="card-header-right">
                            <div class="btn-group card-option">
                                <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="feather icon-more-horizontal"></i>
                                </button>
                                <ul class="list-unstyled card-option dropdown-menu dropdown-menu-right">
                                    <li class="dropdown-item full-card"><a href="#!"><span><i class="feather icon-maximize"></i> maximize</span><span style="display:none"><i class="feather icon-minimize"></i> Restore</span></a></li>
                                    <li class="dropdown-item minimize-card"><a href="#!"><span><i class="feather icon-minus"></i> collapse</span><span style="display:none"><i class="feather icon-plus"></i> expand</span></a></li>
                                    <li class="dropdown-item reload-card"><a href="#!"><i class="feather icon-refresh-cw"></i> reload</a></li>
                                    <li class="dropdown-item close-card"><a href="#!"><i class="feather icon-trash"></i> remove</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="latest-update-box">
                            {% for registration in event_registrations|slice:":2" %} <!-- Loop through registered students -->
                            <div class="row p-b-30">
                                <div class="col-auto text-right update-meta">
                                    <p class="text-muted m-b-0 d-inline-flex">Registered Student</p>
                                    <i class="feather icon-user bg-primary update-icon"></i>
                                </div>
                                <div class="col">
                                    <a href="#!">
                                        <h6>{{ registration.student.full_name }}</h6> <!-- Accessing full name of the student -->
                                    </a>
                                    <p class="text-muted m-b-0">{{ registration.student.course }} - {{ registration.student.branch }}</p>
                                    <p class="text-muted m-b-0">Registered for: {{ registration.event.title }}</p> <!-- Display the event title -->
                                    <form method="post" action="{% url 'approve_registration' registration.id %}"> <!-- Change the URL as per your view -->
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-success btn-sm mt-2">Approve Registration</button> <!-- Approve registration button -->
                                    </form>
                                </div>
                            </div>
                            {% empty %}
                            <div class="row p-b-30">
                                <div class="col text-center">
                                    <p class="text-muted">No students registered for events</p> <!-- Message for no registrations -->
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        <div class="text-center">
                            <a href="{% url 'view_assigned_events' %}" class="b-b-primary text-primary">View all Registered Students</a> <!-- Link to view all registered students -->
                        </div>
                    </div>
                </div>
            </div>
            
            
        </div>
        <!-- Main Content Goes Here -->
    </div>
</div>
<!-- [ Main Content ] end -->

{% endblock content %}

   